
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>The Bitcoin programming language &#8212; Cryptocurrency and the Smileycoin (crypto251.0)  documentation</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Fun and games with Bitcoin" href="lec30100.html" />
    <link rel="prev" title="Automation on the blockchain (stores, ATM, gambling etc)" href="lec26000.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="the-bitcoin-programming-language">
<h1>The Bitcoin programming language<a class="headerlink" href="#the-bitcoin-programming-language" title="Permalink to this headline">¶</a></h1>
<div class="section" id="from-input-to-output">
<h2>From input to output<a class="headerlink" href="#from-input-to-output" title="Permalink to this headline">¶</a></h2>
<p>Tx cc3b743938e485578315b2f6848c1a416c917585ea2f75d5d3e09f21a95008b0 output 0</p>
<img alt="http://tutor-web.net/comp/crypto251.0/images/trans-cc3b.png" src="http://tutor-web.net/comp/crypto251.0/images/trans-cc3b.png" />
<p>“asm:” “OP_DUP OP_HASH160 <strong>df75ee5b514b5253979ed29524fde386482f05cf</strong> OP_EQUALVERIFY OP_CHECKSIG”,</p>
<p>“hex:” “76a914df75ee5b514b5253979ed29524fde386482f05cf88ac”,</p>
<p>i.e.</p>
<p>hex: <strong>76</strong> <strong>a9</strong> 14 <strong>df75ee5b514b5253979ed29524fde386482f05cf</strong> <strong>88</strong> <strong>ac</strong></p>
</div>
<div class="section" id="the-assembler">
<h2>The assembler<a class="headerlink" href="#the-assembler" title="Permalink to this headline">¶</a></h2>
<p>where we see (from <a class="reference external" href="https://en.bitcoin.it/wiki/Script">https://en.bitcoin.it/wiki/Script</a> ) the meaning of the sequence</p>
<p><code class="docutils literal notranslate"><span class="pre">OP_DUP</span> <span class="pre">OP_HASH160</span> <span class="pre">OP_EQUALVERY</span> <span class="pre">OP_CHECKSIG</span> <span class="pre">OP_EQUAL</span> <span class="pre">OP_VERIFY</span></code></p>
<p>in the table in the handout.</p>
<div class="section" id="handout">
<h3>Handout<a class="headerlink" href="#handout" title="Permalink to this headline">¶</a></h3>
<table class="docutils align-default">
<colgroup>
<col style="width: 19%" />
<col style="width: 12%" />
<col style="width: 11%" />
<col style="width: 10%" />
<col style="width: 12%" />
<col style="width: 35%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>code</p></th>
<th class="head"><p>dec</p></th>
<th class="head"><p>hex</p></th>
<th class="head"><p>Input</p></th>
<th class="head"><p>Output</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>OP_DUP</p></td>
<td><p>118</p></td>
<td><p>0x76</p></td>
<td></td>
<td></td>
<td><div class="line-block">
<div class="line">Duplicates the
top stack item.</div>
<div class="line"><br /></div>
</div>
</td>
</tr>
<tr class="row-odd"><td><p>OP_HASH160</p></td>
<td><p>169</p></td>
<td><p>0xa9</p></td>
<td><p>in</p></td>
<td><p>hash</p></td>
<td><div class="line-block">
<div class="line">The input is hashed twice:
first with SHA-256 and then
with RIPEMD-160.</div>
<div class="line"><br /></div>
</div>
</td>
</tr>
<tr class="row-even"><td><p>OP_EQUALVERIFY</p></td>
<td><p>136</p></td>
<td><p>0x88</p></td>
<td><p>x1 x2</p></td>
<td><p>Nothing/fail</p></td>
<td><div class="line-block">
<div class="line">Same as OP_EQUAL, but
runs OP_VERIFY afterward.</div>
<div class="line"><br /></div>
</div>
</td>
</tr>
<tr class="row-odd"><td><p>OP_CHECKSIG</p></td>
<td><p>172</p></td>
<td><p>0xac</p></td>
<td><p>sig pubkey</p></td>
<td><p>True / false</p></td>
<td><div class="line-block">
<div class="line">The entire transaction
outputs, inputs, and script
(from the most recently-executed
OP_CODESEPARATOR to the end)
are hashed. The signature used
by OP_CHECKSIG must be a valid
signature for this hash and
public key. If it is, 1 is
returned, 0 otherwise.</div>
<div class="line"><br /></div>
</div>
</td>
</tr>
<tr class="row-even"><td><p>OP_EQUAL</p></td>
<td><p>135</p></td>
<td><p>0x87</p></td>
<td><p>x1 x2</p></td>
<td><p>True/false</p></td>
<td><div class="line-block">
<div class="line">Returns 1 if the inputs are
exactly equal, 0 otherwise.</div>
<div class="line"><br /></div>
</div>
</td>
</tr>
<tr class="row-odd"><td><p>OP_VERIFY</p></td>
<td><p>105</p></td>
<td><p>0x69</p></td>
<td><div class="line-block">
<div class="line">True /
false</div>
<div class="line"><br /></div>
</div>
</td>
<td><div class="line-block">
<div class="line">Nothing/
/ fail</div>
<div class="line"><br /></div>
</div>
</td>
<td><div class="line-block">
<div class="line">Marks transaction as invalid
if top stack value is not true.
The top stack value is removed.</div>
<div class="line"><br /></div>
</div>
</td>
</tr>
<tr class="row-even"><td></td>
<td><p>20</p></td>
<td><p>0x14</p></td>
<td></td>
<td></td>
<td><div class="line-block">
<div class="line">push 20 bytes onto the stack
the following 160 bit hash</div>
<div class="line"><br /></div>
</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="simple-example">
<h2>Simple example<a class="headerlink" href="#simple-example" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">2</span> <span class="pre">7</span> <span class="pre">OP_ADD</span> <span class="pre">3</span> <span class="pre">OP_SUB</span> <span class="pre">1</span> <span class="pre">OP_ADD</span> <span class="pre">7</span> <span class="pre">OP_EQUAL</span></code>
Example
——-</p>
<p>Consider how the following code would be executed</p>
<p><code class="docutils literal notranslate"><span class="pre">2</span> <span class="pre">7</span> <span class="pre">OP_ADD</span> <span class="pre">3</span> <span class="pre">OP_SUB</span> <span class="pre">1</span> <span class="pre">OP_ADD</span> <span class="pre">7</span> <span class="pre">OP_EQUAL</span></code></p>
<table class="docutils align-default">
<colgroup>
<col style="width: 21%" />
<col style="width: 10%" />
<col style="width: 13%" />
<col style="width: 56%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>2</p></td>
<td></td>
<td></td>
<td><p>2 goes on stack</p></td>
</tr>
<tr class="row-even"><td><p>7</p></td>
<td><p>2</p></td>
<td></td>
<td><p>2 on stack; 7 goes on stack</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>7</p></td>
<td><p>2</p></td>
<td><p>7 and 2 on stack</p></td>
</tr>
<tr class="row-even"><td><p>OP_ADD</p></td>
<td><p>7</p></td>
<td><p>2</p></td>
<td><p>+ operator adds from stack</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>9</p></td>
<td></td>
<td><p>sum gets put on stack</p></td>
</tr>
<tr class="row-even"><td><p>3</p></td>
<td><p>9</p></td>
<td></td>
<td><p>3 goes on stack</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>3</p></td>
<td><p>9</p></td>
<td><p>3 and 9 on stack</p></td>
</tr>
<tr class="row-even"><td><p>OP_SUB</p></td>
<td><p>3</p></td>
<td><p>9</p></td>
<td><p>- operator</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>6</p></td>
<td></td>
<td><p>difference is put on stack</p></td>
</tr>
<tr class="row-even"><td><p>1</p></td>
<td><p>6</p></td>
<td></td>
<td><p>1 goes on stack</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>1</p></td>
<td><p>6</p></td>
<td><p>1 and 6 on stack</p></td>
</tr>
<tr class="row-even"><td><p>OP_ADD</p></td>
<td><p>1</p></td>
<td><p>6</p></td>
<td><p>+ operator adds from stack</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>7</p></td>
<td></td>
<td><p>sum gets put on stack</p></td>
</tr>
<tr class="row-even"><td><p>7</p></td>
<td><p>7</p></td>
<td></td>
<td><p>new 7 to be put on stack</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>7</p></td>
<td><p>7</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>OP_EQUAL</p></td>
<td><p>7</p></td>
<td><p>7</p></td>
<td><p>= operator compares</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>TRUE</p></td>
<td></td>
<td><p>result is TRUE</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="spending">
<h2>spending<a class="headerlink" href="#spending" title="Permalink to this headline">¶</a></h2>
<p>Then the value gets used in</p>
<p>Tx e870614afe3cb9fde97566b024a72f11d22ce08dbd89a971655b15f71d6e203b</p>
<div class="section" id="see-handout-handout">
<h3>(see handout)Handout<a class="headerlink" href="#see-handout-handout" title="Permalink to this headline">¶</a></h3>
<p>with</p>
<p>asm:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mf">30450221009411566e0</span><span class="n">a7965fc5b8a73ca788a52c4fc0d4f6eaf3089812e55</span> \
<span class="n">e7def520c79502205d7db54c0851d650d80e9236ecfbe9a94ea0b17976255f</span> \
<span class="mi">2170259</span><span class="n">b652524d0b301</span>
</pre></div>
</div>
<p>hex:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>4830450221009411566e0a7965fc5b8a73ca788a52c4fc0d4f6eaf3089812e55 \
e7def520c79502205d7db54c0851d650d80e9236ecfbe9a94ea0b17976255f \
2170259b652524d0b3012102df1da8c39a9823016dbe56d11b11b1369b4567 \
4115cbbd9a2a531e365a532bc7``
</pre></div>
</div>
</div>
</div>
<div class="section" id="a-more-detailed-look-inside-the-spending-transaction">
<h2>A more detailed look inside the spending transaction<a class="headerlink" href="#a-more-detailed-look-inside-the-spending-transaction" title="Permalink to this headline">¶</a></h2>
<p>Looking at SMLY transactions</p>
<p><code class="docutils literal notranslate"><span class="pre">dee018b9be101c519ad326c581807581a4e46711f242b4878afa1d98c5f521e1</span></code></p>
<p>and</p>
<p><code class="docutils literal notranslate"><span class="pre">08a5430a667a700e7b913d1895908c56d035559cd32a999a5c8cd56f409f4d15</span></code></p>
<p>The former’s vout:0 gets spent in the latter.
Example
——-</p>
<p>Consider SMLY transactions
<code class="docutils literal notranslate"><span class="pre">dee018b9be101c519ad326c581807581a4e46711f242b4878afa1d98c5f521e1</span></code>
and
<code class="docutils literal notranslate"><span class="pre">08a5430a667a700e7b913d1895908c56d035559cd32a999a5c8cd56f409f4d15</span></code></p>
<p>The former’s <code class="docutils literal notranslate"><span class="pre">vout:0</span></code> gets spent in the latter.</p>
<p>The output of <code class="docutils literal notranslate"><span class="pre">dee0...</span></code></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;vout&quot;</span><span class="p">:</span> <span class="p">[</span>
   <span class="p">{</span>
      <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="mi">61</span><span class="p">,</span>
      <span class="s2">&quot;n&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
      <span class="s2">&quot;scriptPubKey&quot;</span><span class="p">:</span> <span class="p">{</span>
         <span class="s2">&quot;asm&quot;</span><span class="p">:</span> <span class="s2">&quot;OP_DUP OP_HASH160 52a7c9d832b31c044faa63782ef252e7a4a34291 </span><span class="se">\</span>
<span class="s2">                 OP_EQUALVERIFY OP_CHECKSIG&quot;</span><span class="p">,</span>
         <span class="s2">&quot;hex&quot;</span><span class="p">:</span> <span class="s2">&quot;76a91452a7c9d832b31c044faa63782ef252e7a4a3429188ac&quot;</span><span class="p">,</span>
         <span class="s2">&quot;reqSigs&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
         <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;pubkeyhash&quot;</span><span class="p">,</span>
         <span class="s2">&quot;addresses&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="s2">&quot;BBz82bHDLKC3CGMHhJtNPbwTAYFGrRT1o6&quot;</span>
         <span class="p">]</span>
      <span class="p">}</span>
   <span class="p">},</span>
</pre></div>
</div>
<p>and the spending part in 08a5…</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;vin&quot;</span><span class="p">:</span> <span class="p">[</span>
   <span class="p">{</span>
      <span class="s2">&quot;txid&quot;</span><span class="p">:</span> <span class="s2">&quot;dee018b9be101c519ad326c581807581a4e46711f242b4878afa1d98c5f521e1&quot;</span><span class="p">,</span>
      <span class="s2">&quot;vout&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
      <span class="s2">&quot;scriptSig&quot;</span><span class="p">:</span> <span class="p">{</span>
         <span class="s2">&quot;asm&quot;</span><span class="p">:</span> <span class="s2">&quot;3044022050587d300d060b912526164f24b1e24897ed9822b1d23fce9a7c103e1c6b3d2102202b42a536a82582 </span><span class="se">\</span>
<span class="s2">                 ac26495c3a3f5c34add4c1aa2fecede1c50ce5f22fd06739920102188c91a675464d2dc475d4f0 </span><span class="se">\</span>
<span class="s2">                 1bc8cd60fe418d99142ed1ce5f8ce45a997080d5&quot;</span><span class="p">,</span>
         <span class="s2">&quot;hex&quot;</span><span class="p">:</span> <span class="s2">&quot;473044022050587d300d060b912526164f24b1e24897ed9822b1d23fce9a7c103e1c6b3d2102202b42a536a82 </span><span class="se">\</span>
<span class="s2">                 582ac26495c3a3f5c34add4c1aa2fecede1c50ce5f22fd0673992012102188c91a675464d2dc475d4f0 </span><span class="se">\</span>
<span class="s2">                 1bc8cd60fe418d99142ed1ce5f8ce45a997080d5&quot;</span>
      <span class="p">},</span>
      <span class="s2">&quot;sequence&quot;</span><span class="p">:</span> <span class="mi">4294967295</span>
   <span class="p">}</span>
<span class="p">],</span>
</pre></div>
</div>
<p>We want to understand the entire process.</p>
<p>First, to spend the UTXO you need to be the owner of the addres, so verify that:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">validateaddress</span> <span class="n">BBz82bHDLKC3CGMHhJtNPbwTAYFGrRT1o6</span>
<span class="p">{</span>
<span class="s2">&quot;isvalid&quot;</span> <span class="p">:</span> <span class="n">true</span><span class="p">,</span>
<span class="s2">&quot;address&quot;</span> <span class="p">:</span> <span class="s2">&quot;BBz82bHDLKC3CGMHhJtNPbwTAYFGrRT1o6&quot;</span><span class="p">,</span>
<span class="s2">&quot;ismine&quot;</span> <span class="p">:</span> <span class="n">true</span><span class="p">,</span>
<span class="s2">&quot;isscript&quot;</span> <span class="p">:</span> <span class="n">false</span><span class="p">,</span>
<span class="s2">&quot;pubkey&quot;</span> <span class="p">:</span> <span class="s2">&quot;02188c91a675464d2dc475d4f01bc8cd60fe418d99142ed1ce5f8ce45a997080d5&quot;</span><span class="p">,</span>
<span class="s2">&quot;iscompressed&quot;</span> <span class="p">:</span> <span class="n">true</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Note how the validateaddress command also shows the public key and this is the second part in the “asm” string in the spending transaction. You can also verify that this address does indeed correspond to this public key: <a class="reference external" href="https://en.bitcoin.it/wiki/Base58Check_encoding#Creating_a_Base58Check_string">https://en.bitcoin.it/wiki/Base58Check_encoding#Creating_a_Base58Check_string</a></p>
<p>Next, validate the public key to hash transformation, ripemd160(sha256(publickey)) using python:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">hashlib</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">publickey</span> <span class="o">=</span> <span class="s1">&#39;02188c91a675464d2dc475d4f01bc8cd60fe418d99142ed1ce5f8ce45a997080d5&#39;</span> \
<span class="go">                .decode(&#39;hex&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="s1">&#39;sha256&#39;</span><span class="p">,</span>    <span class="n">publickey</span><span class="p">)</span><span class="o">.</span><span class="n">digest</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r</span> <span class="o">=</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="s1">&#39;ripemd160&#39;</span><span class="p">,</span> <span class="n">s</span>        <span class="p">)</span><span class="o">.</span><span class="n">digest</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;hex&#39;</span><span class="p">)</span>
<span class="go">&#39;7c8edaf5fe99c4729e8903271fb5f0f34fdf3e461c4db1890b298b3807964505&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;hex&#39;</span><span class="p">)</span>
<span class="go">&#39;52a7c9d832b31c044faa63782ef252e7a4a34291&#39;</span>
<span class="go">&gt;&gt;&gt;</span>
</pre></div>
</div>
<p>or in R, not so subtle:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span> <span class="n">public</span><span class="o">&lt;-</span><span class="s2">&quot;02188c91a675464d2dc475d4f01bc8cd60fe418d99142ed1ce5f8ce45a997080d5&quot;</span>
<span class="o">&gt;</span> <span class="k">as</span><span class="o">.</span><span class="n">character</span><span class="p">(</span><span class="n">ripemd160</span><span class="p">(</span><span class="n">sha256</span><span class="p">(</span><span class="k">as</span><span class="o">.</span><span class="n">raw</span><span class="p">(</span><span class="n">strtoi</span><span class="p">(</span><span class="n">sapply</span><span class="p">(</span><span class="n">seq</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">nchar</span><span class="p">(</span><span class="n">public</span><span class="p">),</span> <span class="n">by</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span> \
               <span class="n">function</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="n">substr</span><span class="p">(</span><span class="n">public</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)),</span> <span class="mi">16</span><span class="n">L</span><span class="p">)))))</span>
<span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="s2">&quot;52a7c9d832b31c044faa63782ef252e7a4a34291&quot;</span>
</pre></div>
</div>
<p>The final action is to validate the signature, which was the first part of the “asm” string in the spending transaction, i.e.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">3044022050587</span><span class="n">d300d060b912526164f24b1e24897ed9822b1d23fce9a7c103e1c6b3d2102202b42a536a8</span> \
<span class="mi">2582</span><span class="n">ac26495c3a3f5c34add4c1aa2fecede1c50ce5f22fd067399201</span>
</pre></div>
</div>
<p>This is validated using <code class="docutils literal notranslate"><span class="pre">OP_CHECKSIG</span></code> which is the last operation in the locking script. This opcode takes the two values left on the stack, namely the signature and the public key, and validates the signature. The process is fairly involved but can be found here: <a class="reference external" href="https://en.bitcoin.it/wiki/OP_CHECKSIG">https://en.bitcoin.it/wiki/OP_CHECKSIG</a></p>
<p>These various parts of the spending transaction can be reasonably easily found in the hex output from <code class="docutils literal notranslate"><span class="pre">getrawtransaction</span></code> as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">getrawtransaction</span> <span class="mi">08</span><span class="n">a5430a667a700e7b913d1895908c56d035559cd32a999a5c8cd56f409f4d15</span>
<span class="mf">0100000001e121</span><span class="n">f5c5981dfa8a87b442f21167e4a481758081c526d39a511c10beb918e0de</span> \
<span class="mi">000000006</span><span class="n">a473044022050587d300d060b912526164f24b1e24897ed9822b1d23fce9a7c10</span> \
<span class="mf">3e1</span><span class="n">c6b3d2102202b42a536a82582ac26495c3a3f5c34add4c1aa2fecede1c50ce5f22fd067</span> \
<span class="mi">3992012102188</span><span class="n">c91a675464d2dc475d4f01bc8cd60fe418d99142ed1ce5f8ce45a997080d5</span> \
<span class="n">ffffffff0200f2052a010000001976a91401227043367a947a0754e44f0c0da197cc1d929d</span> \
<span class="mi">88</span><span class="n">ac00ca9a3b000000001976a9147283560a1a0e4d5ba2868e3ec7a7d98c6816d4e188ac00000000</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="http://tutor-web.net/comp/crypto251.0/images/getrawtransaction.png"><img alt="alternate text" class="align-right" src="http://tutor-web.net/comp/crypto251.0/images/getrawtransaction.png" style="height: 200.0px;" /></a>
<p>The signature part is seen in green and the public key is given in blue.</p>
<p>As this is the spending transaction it will send outputs to new addresses. The corresponding opcodes are highlighted in yellow: 76=OP_DUP, a9=OP_HASH160, 88=OP_EQUALVERIFY and ac=OP_CHECKSIG. All of these can be found at <a class="reference external" href="https://en.bitcoin.it/wiki/Script">https://en.bitcoin.it/wiki/Script</a>. Right after each 0xa9, one can see 0x14 (=20 decimal) followed by 20 bytes of data, these being the hashed public keys for the new recipients.</p>
<p>Finally, look carefully at the hex code again and you will find the string 00f2052a01 which contains the byte representation of the amount, in <strong>reverse byte order</strong>, so to evaluate the amount, take the reversed hex notation, 0x012a05f200, and convert this to decimal (in R)</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mh">0x012a05f200</span>
<span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="mf">5e+09</span>
</pre></div>
</div>
<p>These amounts are given in units of <span class="math notranslate nohighlight">\(10^{-8}\)</span> SMLY (Smile-oshi?), so these are 50 SMLY, as can be seen by looking at
<a class="reference external" href="https://chainz.cryptoid.info/smly/tx.dws?08a5430a667a700e7b913d1895908c56d035559cd32a999a5c8cd56f409f4d15.htm">https://chainz.cryptoid.info/smly/tx.dws?08a5430a667a700e7b913d1895908c56d035559cd32a999a5c8cd56f409f4d15.htm</a></p>
<p>This can also be computed directly using the algorithm to go from base 16 to base 10:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>          <span class="mi">0</span>    <span class="mi">1</span>    <span class="mi">2</span>       <span class="n">a</span>     <span class="mi">0</span>     <span class="mi">5</span>      <span class="n">f</span>     <span class="mi">2</span>     <span class="mi">0</span>     <span class="mi">0</span>
<span class="o">&gt;</span> <span class="p">((((((((</span><span class="mi">0</span><span class="o">*</span><span class="mi">16</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">16</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="mi">16</span><span class="o">+</span><span class="mi">10</span><span class="p">)</span><span class="o">*</span><span class="mi">16</span><span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">*</span><span class="mi">16</span><span class="o">+</span><span class="mi">5</span><span class="p">)</span><span class="o">*</span><span class="mi">16</span><span class="o">+</span><span class="mi">15</span><span class="p">)</span><span class="o">*</span><span class="mi">16</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="mi">16</span><span class="o">+</span><span class="mi">0</span><span class="p">)</span><span class="o">*</span><span class="mi">16</span><span class="o">+</span><span class="mi">0</span>
<span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="mf">5e+09</span>
</pre></div>
</div>
<p>The other amount is coded as the string
<code class="docutils literal notranslate"><span class="pre">00ca9a3b00000000</span></code>
which amounts to
<code class="docutils literal notranslate"><span class="pre">0x3b9aca00</span></code>
or 10 SMLY.</p>
</div>
<div class="section" id="a-more-detailed-look-at-p2sh">
<h2>A more detailed look at P2SH<a class="headerlink" href="#a-more-detailed-look-at-p2sh" title="Permalink to this headline">¶</a></h2>
<p>A case study in P2SH is given below in the form of using a <strong>multisig address</strong></p>
<p>Several tutorials are available on this topic</p>
<p><a class="reference external" href="https://www.soroushjp.com/2014/12/20/bitcoin-multisig-the-hard-way-understanding-raw-multisignature-bitcoin-transactions/">https://www.soroushjp.com/2014/12/20/bitcoin-multisig-the-hard-way-understanding-raw-multisignature-bitcoin-transactions/</a>
Handout
——-</p>
<p>A detailed explanation of using a multisig address, from setting up through generating the address to deposits and spending.</p>
<div class="section" id="example">
<h3>Example<a class="headerlink" href="#example" title="Permalink to this headline">¶</a></h3>
<p>The addresses are generated on three Linux computers using the command</p>
<p><code class="docutils literal notranslate"><span class="pre">smileycoin-cli</span> <span class="pre">getnewaddress</span></code></p>
<p>on each computer separately.</p>
<p>In this case study the following 3 addresses were obtained, belonging to wallets on 3 different computers</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">BTU58m57Jo61jU3WeWujPj2aZ9LEYLnpYd</span>
<span class="n">BP6AsFWQHPggnXNYTLssykopsx6r3y2Qnh</span>
<span class="n">B66UXukGkPCgasKp9nVTwb93K7XGMzvjTX</span>
</pre></div>
</div>
<p>By running
<code class="docutils literal notranslate"><span class="pre">validateaddress</span></code>
on each computer, the corresponding public key is also shown.</p>
<p>For example, the
<code class="docutils literal notranslate"><span class="pre">validateaddress</span></code>
command on computer 1 resulted in the following output:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">smileycoind</span> <span class="n">validateaddress</span> <span class="n">BTU58m57Jo61jU3WeWujPj2aZ9LEYLnpYd</span>
<span class="p">{</span>
   <span class="s2">&quot;isvalid&quot;</span> <span class="p">:</span> <span class="n">true</span><span class="p">,</span>
   <span class="s2">&quot;address&quot;</span> <span class="p">:</span> <span class="s2">&quot;BTU58m57Jo61jU3WeWujPj2aZ9LEYLnpYd&quot;</span><span class="p">,</span>
   <span class="s2">&quot;ismine&quot;</span> <span class="p">:</span> <span class="n">true</span><span class="p">,</span>
   <span class="s2">&quot;isscript&quot;</span> <span class="p">:</span> <span class="n">false</span><span class="p">,</span>
   <span class="s2">&quot;pubkey&quot;</span> <span class="p">:</span> <span class="s2">&quot;03971fbd962c5b61432efecf07dbf69f93653ea8a14cc104dc71700e7874c63646&quot;</span><span class="p">,</span>
   <span class="s2">&quot;iscompressed&quot;</span> <span class="p">:</span> <span class="n">true</span><span class="p">,</span>
   <span class="s2">&quot;account&quot;</span> <span class="p">:</span> <span class="s2">&quot;&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Note that requesting this exact
<code class="docutils literal notranslate"><span class="pre">validateaddress</span></code>
on another computer will not give the public key, which will be required later. Thus the
<code class="docutils literal notranslate"><span class="pre">validateaddress</span></code>
command needs to be executed on each of the three computers.</p>
<p>In our example we obtain:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Address</span>                            <span class="o">-</span> <span class="n">Public</span> <span class="n">key</span>
<span class="n">BTU58m57Jo61jU3WeWujPj2aZ9LEYLnpYd</span> <span class="o">-</span> <span class="mi">03971</span><span class="n">fbd962c5b61432efecf07dbf69f93653ea8a14cc104dc71700e7874c63646</span>
<span class="n">BP6AsFWQHPggnXNYTLssykopsx6r3y2Qnh</span> <span class="o">-</span> <span class="mi">02</span><span class="n">b416988c8f209b4ccddb96132685882932405641bac69ba3cae38dd21f619983</span>
<span class="n">B66UXukGkPCgasKp9nVTwb93K7XGMzvjTX</span> <span class="o">-</span> <span class="mi">0380304</span><span class="n">a74398b04af944831a4e51c41cc0c9f29d4b25f6530976d46db3fee65df</span>
</pre></div>
</div>
<p>Normally the process would involve three different individuals as it is usually of importance that the three signatures be independent. Thus no one person should know all private keys nor have access to the three
wallets.</p>
<p>At this stage we have all the information to set up a
<code class="docutils literal notranslate"><span class="pre">multisig</span> <span class="pre">address</span></code>
where two of the three signatures are required for spending.</p>
<p>We have two methods for generating the address. The first and simpler is
<code class="docutils literal notranslate"><span class="pre">addmultisigaddress</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">smileyCoin</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">smileycoin</span><span class="o">-</span><span class="n">cli</span> <span class="n">addmultisigaddress</span> <span class="mi">2</span> \
<span class="s1">&#39;[&quot;0380304a74398b04af944831a4e51c41cc0c9f29d4b25f6530976d46db3fee65df&quot;,</span><span class="se">\</span>
<span class="s1">&quot;02b416988c8f209b4ccddb96132685882932405641bac69ba3cae38dd21f619983&quot;,</span><span class="se">\</span>
<span class="s1">&quot;03971fbd962c5b61432efecf07dbf69f93653ea8a14cc104dc71700e7874c63646&quot;]&#39;</span>
<span class="o">**</span><span class="mi">3</span><span class="n">KZ98MnX4Uzv7hcQNyA5QfMaGCqLvbF3Sp</span><span class="o">**</span>
</pre></div>
</div>
<p>The output from the command is the “multisig address” or “script hash”, <strong>3KZ98MnX4Uzv7hcQNyA5QfMaGCqLvbF3Sp</strong>.</p>
<p>Note that the backslashes are not a part of the command, which should be all on one line.</p>
<p>Note also that all three public keys are used when generating the
address, which is not a traditional address but a hash which can receive payments just like a regular address.</p>
<p>The second method is to use the
<code class="docutils literal notranslate"><span class="pre">createmultisig</span></code>
command. This is very similar:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">smileycoin</span><span class="o">-</span><span class="n">cli</span> <span class="n">createmultisig</span> <span class="mi">2</span>
<span class="s1">&#39;[&quot;0380304a74398b04af944831a4e51c41cc0c9f29d4b25f6530976d46db3fee65df&quot;,</span><span class="se">\</span>
<span class="s1">  &quot;02b416988c8f209b4ccddb96132685882932405641bac69ba3cae38dd21f619983&quot;,</span><span class="se">\</span>
<span class="s1">  &quot;03971fbd962c5b61432efecf07dbf69f93653ea8a14cc104dc71700e7874c63646&quot;]&#39;</span>
</pre></div>
</div>
<p>but provides more output, which will be used later:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
   <span class="s2">&quot;address&quot;</span> <span class="p">:</span> <span class="s2">&quot;3KZ98MnX4Uzv7hcQNyA5QfMaGCqLvbF3Sp&quot;</span><span class="p">,</span>
   <span class="s2">&quot;redeemScript&quot;</span> <span class="p">:</span> <span class="s2">&quot;52210380304a74398b04af944831a4e51c41cc0c9f29d4b25f6530976d46db</span><span class="se">\</span>
<span class="s2">                     3fee65df2102b416988c8f209b4ccddb96132685882932405641bac69ba3ca</span><span class="se">\</span>
<span class="s2">                     e38dd21f6199832103971fbd962c5b61432efecf07dbf69f93653ea8a14cc1</span><span class="se">\</span>
<span class="s2">                     04dc71700e7874c6364653ae&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Note that the
<code class="docutils literal notranslate"><span class="pre">redeemScript</span></code>
is on one line but is merely printed here on multiple lines (as indicated by the backslash, the continuation symbol).</p>
<p>The redeemScript will be used later, when we will find a way to spend from the address.</p>
<p>Also note that the multisig address is the same as before: If you use the same three public keys and request the same number of signatures, then the same address is generated.</p>
<p>Now, note that the address is valid on all machines, but it is only “mine” on machines which know how it was generated, as seen in this session on another one of the three:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">smileycoin</span><span class="o">-</span><span class="n">cli</span> <span class="n">validateaddress</span> <span class="mi">3</span><span class="n">KZ98MnX4Uzv7hcQNyA5QfMaGCqLvbF3Sp</span>
<span class="p">{</span>
<span class="s2">&quot;isvalid&quot;</span> <span class="p">:</span> <span class="n">true</span><span class="p">,</span>
<span class="s2">&quot;address&quot;</span> <span class="p">:</span> <span class="s2">&quot;3KZ98MnX4Uzv7hcQNyA5QfMaGCqLvbF3Sp&quot;</span><span class="p">,</span>
<span class="s2">&quot;ismine&quot;</span> <span class="p">:</span> <span class="n">false</span>
<span class="p">}</span>
</pre></div>
</div>
<dl class="simple">
<dt>Now we can send to this “address”::</dt><dd><p>smileyCoin/src/smileycoind sendtoaddress 3KZ98MnX4Uzv7hcQNyA5QfMaGCqLvbF3Sp 1000
f05d1c98d761f1b53727436c2b168bcb4f4e17e92779d065a8ca928f17089e60</p>
</dd>
</dl>
<p>The transaction Id can be viewed by using
<code class="docutils literal notranslate"><span class="pre">getrawtransaction</span></code>
followed by
<code class="docutils literal notranslate"><span class="pre">decoderawtransaction</span></code></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">smileyCoin</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">smileycoind</span>  <span class="n">decoderawtransaction</span> \
<span class="mi">010000000113</span><span class="n">adb392c276310901597edfdae180cdaa60f71bcbe1148419e27b</span>\
<span class="n">dc6718bf20000000006a47304402204d1ffe1c1d6d03d03912e6ecc495ff1172</span>\
<span class="n">cc61530e17402d436069a6afa33b0a0220036436af1c0d60af4973b07d5e54c8</span>\
<span class="n">ad8830ecb4686354e6cd71a8e766975338012103a75b127dcb90966b99ae8951</span>\
<span class="n">ac83b6fb57752f80138125042d14cafeac8e0cd1ffffffff0200e87648170000</span>\
<span class="mi">0017</span><span class="n">a914c3f4f3243886b8ed77a9d4d464d27be55ae7000b8700ff0f270b0000</span>\
<span class="mi">001976</span><span class="n">a91462745ef11b10e42f05799d1ea6e1289537d52cf388ac00000000</span>
<span class="p">{</span>
   <span class="s2">&quot;txid&quot;</span> <span class="p">:</span> <span class="s2">&quot;f05d1c98d761f1b53727436c2b168bcb4f4e17e92779d065a8ca928f17089e60&quot;</span><span class="p">,</span>
   <span class="s2">&quot;version&quot;</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
   <span class="s2">&quot;locktime&quot;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
   <span class="s2">&quot;vin&quot;</span> <span class="p">:</span> <span class="p">[</span>
       <span class="p">{</span>
           <span class="s2">&quot;txid&quot;</span> <span class="p">:</span> <span class="s2">&quot;20bf1867dc7be2198414e1cb1bf760aacd80e1dadf7e5901093176c292b3ad13&quot;</span><span class="p">,</span>
           <span class="s2">&quot;vout&quot;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
           <span class="s2">&quot;scriptSig&quot;</span> <span class="p">:</span> <span class="p">{</span>
               <span class="s2">&quot;asm&quot;</span> <span class="p">:</span> <span class="s2">&quot;304402204d1ffe1c1d6d03d03912e6ecc495ff1172cc61530e17402d436069a6</span><span class="se">\</span>
<span class="s2">                        afa33b0a0220036436af1c0d60af4973b07d5e54c8ad8830ecb4686354e6cd71a8e76697533801</span>
                        <span class="mi">03</span><span class="n">a75b127dcb90966b99ae8951ac83b6fb57752f80138125042d14cafeac8e0cd1</span><span class="s2">&quot;,</span>
               <span class="s2">&quot;hex&quot;</span> <span class="p">:</span> <span class="s2">&quot;47304402204d1ffe1c1d6d03d03912e6ecc495ff1172cc61530e17402d436069</span><span class="se">\</span>
<span class="s2">                        a6afa33b0a0220036436af1c0d60af4973b07d5e54c8ad8830ecb4686354e6cd</span><span class="se">\</span>
<span class="s2">                        71a8e766975338012103a75b127dcb90966b99ae8951ac83b6fb57752f801381</span><span class="se">\</span>
<span class="s2">                        25042d14cafeac8e0cd1&quot;</span>
           <span class="p">},</span>
           <span class="s2">&quot;sequence&quot;</span> <span class="p">:</span> <span class="mi">4294967295</span>
       <span class="p">}</span>
   <span class="p">],</span>
   <span class="s2">&quot;vout&quot;</span> <span class="p">:</span> <span class="p">[</span>
       <span class="p">{</span>
           <span class="s2">&quot;value&quot;</span> <span class="p">:</span> <span class="mf">1000.00000000</span><span class="p">,</span>
           <span class="s2">&quot;n&quot;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
           <span class="s2">&quot;scriptPubKey&quot;</span> <span class="p">:</span> <span class="p">{</span>
               <span class="s2">&quot;asm&quot;</span> <span class="p">:</span> <span class="s2">&quot;OP_HASH160 c3f4f3243886b8ed77a9d4d464d27be55ae7000b OP_EQUAL&quot;</span><span class="p">,</span>
               <span class="s2">&quot;hex&quot;</span> <span class="p">:</span> <span class="s2">&quot;a914c3f4f3243886b8ed77a9d4d464d27be55ae7000b87&quot;</span><span class="p">,</span>
               <span class="s2">&quot;reqSigs&quot;</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
               <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="s2">&quot;scripthash&quot;</span><span class="p">,</span>
               <span class="s2">&quot;addresses&quot;</span> <span class="p">:</span> <span class="p">[</span>
                   <span class="s2">&quot;3KZ98MnX4Uzv7hcQNyA5QfMaGCqLvbF3Sp&quot;</span>
               <span class="p">]</span>
           <span class="p">}</span>
       <span class="p">},</span>
       <span class="p">{</span>
           <span class="s2">&quot;value&quot;</span> <span class="p">:</span> <span class="mf">479.00000000</span><span class="p">,</span>
           <span class="s2">&quot;n&quot;</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
           <span class="s2">&quot;scriptPubKey&quot;</span> <span class="p">:</span> <span class="p">{</span>
               <span class="s2">&quot;asm&quot;</span> <span class="p">:</span> <span class="s2">&quot;OP_DUP OP_HASH160 62745ef11b10e42f05799d1ea6e1289537d52cf3 OP_EQUALVERIFY OP_CHECKSIG&quot;</span><span class="p">,</span>
               <span class="s2">&quot;hex&quot;</span> <span class="p">:</span> <span class="s2">&quot;76a91462745ef11b10e42f05799d1ea6e1289537d52cf388ac&quot;</span><span class="p">,</span>
               <span class="s2">&quot;reqSigs&quot;</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
               <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="s2">&quot;pubkeyhash&quot;</span><span class="p">,</span>
               <span class="s2">&quot;addresses&quot;</span> <span class="p">:</span> <span class="p">[</span>
                   <span class="s2">&quot;BDRfF71aUNzBWdgw3f7W8Ai1pwF7DVPiC8&quot;</span>
               <span class="p">]</span>
           <span class="p">}</span>
       <span class="p">}</span>
   <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Check the amount in the P2SH address:
<a class="reference external" href="https://chainz.cryptoid.info/smly/address.dws?3KZ98MnX4Uzv7hcQNyA5QfMaGCqLvbF3Sp.htm">https://chainz.cryptoid.info/smly/address.dws?3KZ98MnX4Uzv7hcQNyA5QfMaGCqLvbF3Sp.htm</a></p>
<p><strong>Creating the raw transaction</strong></p>
<dl class="simple">
<dt>Recall that the UTXO is::</dt><dd><p>vout: 0
txid: f05d1c98d761f1b53727436c2b168bcb4f4e17e92779d065a8ca928f17089e60</p>
</dd>
</dl>
<p>and this needs to be specified in the transaction.</p>
<p>Now we are all set to try to spend the funds:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">createrawtransaction</span> <span class="s1">&#39;[{&quot;txid&quot;:&quot;f05d1c98d761f1b53727436c2b168bcb4f4e17e92779d065a8ca928f17089e60&quot;,&quot;vout&quot;:0}]&#39;</span> \
                     <span class="s1">&#39;{&quot;BNVZ3mJ2jadZtEfT8wyw6ttHVuZFos9Vw3&quot;:100,&quot;3KZ98MnX4Uzv7hcQNyA5QfMaGCqLvbF3Sp&quot;:899}&#39;</span>

<span class="mf">0100000001609e08178</span><span class="n">f92caa865d07927e9174e4fcb8b162b6c432737b5f161d7981c5df00000000000</span>\
<span class="n">ffffffff0200e40b54020000001976a914c5e9feb90ddcd06bb538ec87ab13643121b5131388ac002375</span>\
<span class="n">ee1400000017a914c3f4f3243886b8ed77a9d4d464d27be55ae7000b8700000000</span>
</pre></div>
</div>
<p>Alternatively we may be on a machine which does not know about the redeemScript and then we need to provide it, aka Gavin Andersen:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">smileycoin</span><span class="o">-</span><span class="n">cli</span> <span class="n">createrawtransaction</span> \
<span class="s1">&#39;[{&quot;txid&quot;:&quot;f05d1c98d761f1b53727436c2b168bcb4f4e17e92779d065a8ca928f17089e60&quot;,</span><span class="se">\</span>
<span class="s1">   &quot;vout&quot;:0,</span><span class="se">\</span>
<span class="s1">   &quot;scriptPubKey&quot;:&quot;a914c3f4f3243886b8ed77a9d4d464d27be55ae7000b87&quot;,</span><span class="se">\</span>
<span class="s1">   &quot;redeemScript&quot;:&quot;52210380304a74398b04af944831a4e51c41cc0c9f29d4b</span><span class="se">\</span>
<span class="s1">                   25f6530976d46db3fee65df2102b416988c8f209b4ccddb</span><span class="se">\</span>
<span class="s1">                   96132685882932405641bac69ba3cae38dd21f619983210</span><span class="se">\</span>
<span class="s1">                   3971fbd962c5b61432efecf07dbf69f93653ea8a14cc104</span><span class="se">\</span>
<span class="s1">                   dc71700e7874c6364653ae&quot;}]&#39;</span> \
 <span class="s1">&#39;{&quot;BNVZ3mJ2jadZtEfT8wyw6ttHVuZFos9Vw3&quot;:100,&quot;3KZ98MnX4Uzv7hcQNyA5QfMaGCqLvbF3Sp&quot;:899}&#39;</span>
</pre></div>
</div>
<p>and this gives a fully constructed transaction as before:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mf">0100000001609e08178</span><span class="n">f92caa865d07927e9174e4fcb8b162b6c432737b5f161d</span>\
<span class="mi">7981</span><span class="n">c5df00000000000ffffffff0200e40b54020000001976a914c5e9feb90ddc</span>\
<span class="n">d06bb538ec87ab13643121b5131388ac002375ee1400000017a914c3f4f324388</span>\
<span class="mi">6</span><span class="n">b8ed77a9d4d464d27be55ae7000b8700000000</span>
</pre></div>
</div>
<p>This transaction needs to be signed by at least two of the three address-holders.</p>
<p><strong>User 1</strong>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>pi@raspberrypi ~ $ smileyCoin/src/smileycoind signrawtransaction
0100000001609e08178f92caa865d07927e9174e4fcb8b162b6c432737b5f161d7981c5df00000000000ffffffff0200e40b54020000001976a914c5e9feb90ddcd06bb538ec87ab13643121b5131388ac002375ee1400000017a914c3f4f3243886b8ed77a9d4d464d27be55ae7000b8700000000
{
   &quot;hex&quot; : &quot;0100000001609e08178f92caa865d07927e9174e4fcb8b162b6c432737b5f161d7981c5df000000000b500483045022100ad97bd7a35043187ac1972db1127f3fd74e63f5e3b2a1c660bff29a62ffb786a02201853bddb9ff92c96e5a09b442455b39234de898e03ac8516717c43f0ac6e7190014c6952210380304a74398b04af944831a4e51c41cc0c9f29d4b25f6530976d46db3fee65df2102b416988c8f209b4ccddb96132685882932405641bac69ba3cae38dd21f6199832103971fbd962c5b61432efecf07dbf69f93653ea8a14cc104dc71700e7874c6364653aeffffffff0200e40b54020000001976a914c5e9feb90ddcd06bb538ec87ab13643121b5131388ac002375ee1400000017a914c3f4f3243886b8ed77a9d4d464d27be55ae7000b8700000000&quot;,
   &quot;complete&quot; : false
}
</pre></div>
</div>
<p><strong>User 2</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">signrawtransaction</span>
<span class="mf">0100000001609e08178</span><span class="n">f92caa865d07927e9174e4fcb8b162b6c432737b5f161d7981c5df000000000b500483045022100ad97bd7a35043187ac1972db1127f3fd74e63f5e3b2a1c660bff29a62ffb786a02201853bddb9ff92c96e5a09b442455b39234de898e03ac8516717c43f0ac6e7190014c6952210380304a74398b04af944831a4e51c41cc0c9f29d4b25f6530976d46db3fee65df2102b416988c8f209b4ccddb96132685882932405641bac69ba3cae38dd21f6199832103971fbd962c5b61432efecf07dbf69f93653ea8a14cc104dc71700e7874c6364653aeffffffff0200e40b54020000001976a914c5e9feb90ddcd06bb538ec87ab13643121b5131388ac002375ee1400000017a914c3f4f3243886b8ed77a9d4d464d27be55ae7000b8700000000</span>

<span class="p">{</span>
<span class="s2">&quot;hex&quot;</span> <span class="p">:</span> <span class="s2">&quot;0100000001609e08178f92caa865d07927e9174e4fcb8b162b6c432737b5f161d7981c5df000000000fdfe0000483045022100b3c3d230fa677230b05f352a1c5481d4ad6792e579f2d559069563ad412c3ebd02207c5cf419d4a2a5fb242d840491b664ba69ae5fd2547adb790b7c9b1aa8ff34e801483045022100ad97bd7a35043187ac1972db1127f3fd74e63f5e3b2a1c660bff29a62ffb786a02201853bddb9ff92c96e5a09b442455b39234de898e03ac8516717c43f0ac6e7190014c6952210380304a74398b04af944831a4e51c41cc0c9f29d4b25f6530976d46db3fee65df2102b416988c8f209b4ccddb96132685882932405641bac69ba3cae38dd21f6199832103971fbd962c5b61432efecf07dbf69f93653ea8a14cc104dc71700e7874c6364653aeffffffff0200e40b54020000001976a914c5e9feb90ddcd06bb538ec87ab13643121b5131388ac002375ee1400000017a914c3f4f3243886b8ed77a9d4d464d27be55ae7000b8700000000&quot;</span><span class="p">,</span>
<span class="s2">&quot;complete&quot;</span> <span class="p">:</span> <span class="n">true</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Note how the second signature generates a valid transaction (complete=true).</p>
<p>This transaction is seen as</p>
<p><a class="reference external" href="https://chainz.cryptoid.info/smly/tx.dws?b781767195aec4ecf0f0aa0dca550c5ecd8fd90f6617b7eec8cdd7beb2256e68.htm">https://chainz.cryptoid.info/smly/tx.dws?b781767195aec4ecf0f0aa0dca550c5ecd8fd90f6617b7eec8cdd7beb2256e68.htm</a></p>
</div>
</div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">Cryptocurrency and the Smileycoin (crypto251.0)</a></h1>








<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="lec00100.html">Introduction to cryptocurrencies</a></li>
<li class="toctree-l1"><a class="reference internal" href="lec00200.html">Bitcoin and Smileycoin basics</a></li>
<li class="toctree-l1"><a class="reference internal" href="lec00300.html">Picking up a wallet</a></li>
<li class="toctree-l1"><a class="reference internal" href="lec00400.html">Compiling the wallet</a></li>
<li class="toctree-l1"><a class="reference internal" href="lec00500.html">Introduction to the SMLY command line</a></li>
<li class="toctree-l1"><a class="reference internal" href="lec01200.html">Basic cryptocurrency economics</a></li>
<li class="toctree-l1"><a class="reference internal" href="lec01400.html">The transaction</a></li>
<li class="toctree-l1"><a class="reference internal" href="lec01500.html">The block and the blockchain</a></li>
<li class="toctree-l1"><a class="reference internal" href="lec01600.html">Cryptocurrency mining</a></li>
<li class="toctree-l1"><a class="reference internal" href="lec02000.html">Cryptography and cryptocurrencies</a></li>
<li class="toctree-l1"><a class="reference internal" href="lec02100.html">Hash function introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="lec02200.html">Elliptic curves</a></li>
<li class="toctree-l1"><a class="reference internal" href="lec03000.html">The trilogy: tutor-web, Smileycoin and Education in a Suitcase</a></li>
<li class="toctree-l1"><a class="reference internal" href="lec03100.html">The SmileyCoin Fund</a></li>
<li class="toctree-l1"><a class="reference internal" href="lec03200.html">Splitting the coinbase: No longer just a miner’s fee</a></li>
<li class="toctree-l1"><a class="reference internal" href="lec03400.html">Staking and proof-of-stake</a></li>
<li class="toctree-l1"><a class="reference internal" href="lec03500.html">The tutor-web as a faucet</a></li>
<li class="toctree-l1"><a class="reference internal" href="lec04000.html">The command line from a Linux script</a></li>
<li class="toctree-l1"><a class="reference internal" href="lec04500.html">Building slightly more complex transactions on the command line</a></li>
<li class="toctree-l1"><a class="reference internal" href="lec15000.html">Cryptocurrency exchanges</a></li>
<li class="toctree-l1"><a class="reference internal" href="lec15500.html">API access to exchanges</a></li>
<li class="toctree-l1"><a class="reference internal" href="lec26000.html">Automation on the blockchain  (stores, ATM, gambling etc)</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">The Bitcoin programming language</a></li>
<li class="toctree-l1"><a class="reference internal" href="lec30100.html">Fun and games with Bitcoin</a></li>
<li class="toctree-l1"><a class="reference internal" href="lec31000.html">The SmileyCoin Fund revisited</a></li>
<li class="toctree-l1"><a class="reference internal" href="lec47000.html">Atomic swaps</a></li>
<li class="toctree-l1"><a class="reference internal" href="lec47100.html">More on atomic swaps and smart contracts</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="lec26000.html" title="previous chapter">Automation on the blockchain  (stores, ATM, gambling etc)</a></li>
      <li>Next: <a href="lec30100.html" title="next chapter">Fun and games with Bitcoin</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2020, Gunnar Stefansson.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 2.2.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/lec30000.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>